CREATE DATABASE IF NOT EXISTS GENDER_STAT_DB;

USE GENDER_STAT_DB;

DROP TABLE IF EXISTS Q1_DATA;

CREATE TABLE IF NOT EXISTS Q1_DATA(CountryName varchar(50), IndicatorCode varchar(50),
YearsByCountry int, Data double)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|';

LOAD DATA INPATH 'project2-sqoop-q1/part-m-00000' INTO TABLE Q1_DATA;

CREATE TABLE FINAL_OUTPUT_Q1 AS 
SELECT CountryName, (AVG(Data)) AS Average
FROM q1_data
GROUP BY CountryName
HAVING Average < 30;